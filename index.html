<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=375, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ë§¤ì¼ë¨¸ë‹ˆë°›ê¸° - ì¹´ë“œ í•œë²ˆì— ì—´ê¸°</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #1a1a1a;
      margin: 0;
      padding: 20px 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 16px;
    }

    .device-frame {
      width: 375px;
      height: 812px;
      background: linear-gradient(180deg, #000000 0%, #26304b 100%);
      overflow: clip;
      position: relative;
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    /* ë°°ê²½ ê·¸ë˜í”½ ë ˆì´ì–´ */
    .bg-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    .bg-layer .bg-image {
      position: absolute;
      width: 730px;
      height: 864px;
      left: -177px;
      top: -50px;
      object-fit: cover;
    }

    .bg-layer .bg-blur {
      position: absolute;
      width: 180px;
      height: 280px;
      left: 114px;
      top: 332px;
      background: #000;
      filter: blur(25px);
      opacity: 0.8;
    }

    /* ========== Status Bar ========== */
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 24px 10px;
      background: #fff;
      height: 44px;
    }

    .status-time {
      font-size: 15px;
      font-weight: 600;
      color: #000;
    }

    .status-icons {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* ========== Navigation ========== */
    .nav-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 16px 12px;
      background: #fff;
      height: 44px;
    }

    .nav-back {
      display: flex;
      align-items: center;
      gap: 6px;
      color: #000;
      font-size: 17px;
      font-weight: 400;
      cursor: pointer;
    }

    .nav-back svg {
      width: 10px;
      height: 18px;
    }

    .nav-home {
      width: 24px;
      height: 24px;
      cursor: pointer;
    }

    /* ========== Tab Menu ========== */
    .tab-menu {
      display: flex;
      background: transparent;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      height: 48px;
      width: 100%;
      flex-shrink: 0;
      position: relative;
      z-index: 5;
    }

    .tab-item {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      color: #666;
      cursor: pointer;
      position: relative;
      font-weight: 500;
    }

    .tab-item.active {
      color: #fff;
      font-weight: 600;
    }

    .tab-item.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 50%;
      transform: translateX(-50%);
      width: 56px;
      height: 2px;
      background: #fff;
    }

    /* ========== ìƒë‹¨ ê³ ì • ì˜ì—­ ========== */
    .top-fixed-area {
      flex-shrink: 0;
      position: relative;
      z-index: 20;
    }

    /* ========== ê°€ë³€ ì˜ì—­ (ì¹´ë“œ ì˜ì—­) ========== */
    .flexible-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: visible;
      position: relative;
      min-height: 0;
      z-index: 5;
    }

    /* ========== í•˜ë‹¨ ê³ ì • ì˜ì—­ ========== */
    .bottom-fixed-area {
      flex-shrink: 0;
    }

    /* Background with blue glow */
    .bg-container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: transparent;
      pointer-events: none;
    }

    .bg-glow {
      display: none;
    }

    /* ========== Main Content ========== */
    .main-content {
      position: relative;
      z-index: 5;
      width: 100%;
      padding: 32px 20px 0;
      flex-shrink: 0;
    }

    /* Money Summary */
    .money-summary {
      text-align: center;
      margin-bottom: 12px;
      position: relative;
    }

    .money-summary .info-icon {
      position: absolute;
      top: 0;
      right: 0;
      width: 22px;
      height: 22px;
      cursor: pointer;
      opacity: 0.5;
    }

    .money-info h2 {
      font-size: 14px;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 6px;
    }

    .money-amount {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2px;
    }

    .money-amount span {
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-size: 26px;
      font-weight: 600;
      color: #fff;
      letter-spacing: -1px;
    }

    .money-amount svg {
      width: 20px;
      height: 20px;
      margin-left: 4px;
      opacity: 0.5;
    }

    /* Card Count Badge */
    .card-badges {
      display: flex;
      justify-content: center;
      margin-bottom: 24px;
    }

    .badge-container {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      background: #1b202f;
      border-radius: 100px;
    }

    .badge-label {
      color: #E0E0E0;
      text-align: center;
      font-family: 'Pretendard', sans-serif;
      font-size: 12px;
      font-style: normal;
      font-weight: 400;
      line-height: 120%;
      letter-spacing: -0.24px;
      white-space: nowrap;
    }

    .badge-divider {
      width: 1px;
      height: 9px;
      background: rgba(255, 255, 255, 0.2);
    }

    .badge-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .badge-items {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge-icon {
      width: 15px;
      height: 20px;
      min-width: 15px;
      min-height: 20px;
      flex-shrink: 0;
      border-radius: 1px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      font-size: 0;
      color: transparent;
    }

    .badge-icon.special {
      background-image: url('./images/card_list_special.png');
    }

    .badge-icon.mileage {
      background-image: url('./images/card_list_default.png');
    }

    .badge-count {
      font-family: 'Pretendard', sans-serif;
      font-size: 12px;
      font-weight: 400;
      color: #e0e0e0;
      line-height: 1.2;
      letter-spacing: -0.24px;
    }

    /* ========== Card Wrapper ========== */
    .card-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 24px;
      width: 100%;
      overflow: visible;
      position: relative;
      z-index: 10;
    }

    /* ========== Card Area ========== */
    .card-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      width: 100%;
      flex: 0 0 auto;
      padding-top: 0;
      height: 332px;
    }

    /* Card Stack */
    .card-stack {
      position: relative;
      width: 230px;
      height: 320px;
      perspective: 1000px;
    }

    /* Flip Card Container */
    .flip-card {
      position: absolute;
      width: 200px;
      height: 300px;
      left: 50%;
      top: 50%;
      transform-style: preserve-3d;
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
    }

    /* ë§¨ ë’¤ ì¹´ë“œ (ìˆ¨ê¹€) */
    .flip-card:nth-child(1) {
      transform: translate(-50%, -50%) translateX(6px) translateY(-5px) rotate(8deg);
      z-index: 1;
      opacity: 0;
    }

    /* ë’·ì¥ (ë³´ì„, 8ë„ ê¸°ìš¸ê¸°) */
    .flip-card:nth-child(2) {
      transform: translate(-50%, -50%) translateX(6px) translateY(-5px) rotate(8deg);
      z-index: 2;
      opacity: 1;
    }

    /* ë§¨ ì•ì¥ (ë³´ì„, 0ë„) */
    .flip-card:nth-child(3) {
      transform: translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg);
      z-index: 3;
      opacity: 1;
    }

    /* í”Œë¦½ ìƒíƒœ */
    .flip-card.flipping {
      transform: translate(-50%, -50%) translateY(0) rotateY(180deg);
      z-index: 10;
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* ì¹´ë“œ íƒ­+í”Œë¦½ í†µí•© ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes pressAndFlip {
      0% {
        transform: translate(-50%, -50%) scale(1) rotateY(0deg);
      }
      5% {
        transform: translate(-50%, -50%) scale(0.88) rotateY(0deg);
      }
      12% {
        transform: translate(-50%, -50%) scale(1.06) rotateY(0deg);
      }
      30% {
        transform: translate(-50%, -50%) scale(1.03) rotateY(30deg);
      }
      45% {
        transform: translate(-50%, -50%) scale(1.08, 1.02) rotateY(70deg);
      }
      50% {
        transform: translate(-50%, -50%) scale(1.12, 1) rotateY(90deg);
      }
      55% {
        transform: translate(-50%, -50%) scale(1.08, 1.02) rotateY(110deg);
      }
      70% {
        transform: translate(-50%, -50%) scale(1.02) rotateY(150deg);
      }
      85% {
        transform: translate(-50%, -50%) scale(1.01) rotateY(175deg);
      }
      100% {
        transform: translate(-50%, -50%) scale(1) rotateY(180deg);
      }
    }
    
    .flip-card.press-flip {
      animation: pressAndFlip 0.75s cubic-bezier(0.4, 0, 0.7, 1) forwards;
      z-index: 10;
    }


    /* ë‹¤ìŒ ì¹´ë“œê°€ ì•ìœ¼ë¡œ ë‚˜ì˜¤ëŠ” ìƒíƒœ */
    .flip-card.move-front {
      transform: translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg) !important;
      z-index: 3 !important;
      opacity: 1 !important;
    }

    /* ëŒ€ê¸° ì¹´ë“œê°€ ë’·ì¥ ìœ„ì¹˜ë¡œ ì˜¤ëŠ” ìƒíƒœ */
    .flip-card.move-back {
      transform: translate(-50%, -50%) translateX(6px) translateY(-5px) rotate(8deg) !important;
      z-index: 2 !important;
      opacity: 1 !important;
    }

    .flip-card.hidden {
      opacity: 0 !important;
      pointer-events: none;
    }

    /* ì¹´ë“œ í•©ì³ì§€ëŠ” ìƒíƒœ (í•œë²ˆì— ì—´ê¸°) */
    .flip-card.merge {
      transform: translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg) !important;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    /* ì¹´ë“œ ìŠ¤ì¼€ì¼ ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ (ìŠ¤ë¬´ìŠ¤í•˜ê³  ë¶€ë“œëŸ½ê²Œ) */
    @keyframes cardScaleBounce {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.025); }
    }

    .flip-card.bounce {
      animation: cardScaleBounce 1s cubic-bezier(0.45, 0, 0.55, 1) 2 !important;
    }

    /* í•©ì³ì§„ í›„ í”Œë¦½ */
    .flip-card.merge-flip {
      transform: translate(-50%, -50%) translateY(0) rotateY(180deg);
      z-index: 10;
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }


    /* Card Front (ì¼ë°˜ ì•ë©´) */
    .card-front {
      position: absolute;
      width: 100%;
      height: 100%;
      background: url('./images/card-front.png') center/cover no-repeat;
      border-radius: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      backface-visibility: hidden;
      overflow: hidden;
      cursor: pointer;
    }

    /* Special Card Front (ìŠ¤í˜ì…œ ì•ë©´) */
    .card-front-special {
      background: url('./images/card-special-front.png') center/cover no-repeat;
    }
    
    .card-front:active {
      transform: scale(0.96);
      transition: transform 0.1s ease-out;
    }

    /* ì¹´ë“œ ë³´ë” ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
    .card-front::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 8px;
      padding: 2px;
      background: linear-gradient(90deg, transparent, transparent);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0;
      pointer-events: none;
    }

    .flip-card.border-loading .card-front::before {
      opacity: 1;
      background: conic-gradient(
        from var(--border-angle, 0deg),
        transparent 0deg,
        transparent 60deg,
        rgba(255, 255, 255, 0.9) 90deg,
        rgba(120, 200, 255, 1) 120deg,
        rgba(255, 255, 255, 0.9) 150deg,
        transparent 180deg,
        transparent 360deg
      );
      animation: borderRotate 1.5s linear infinite;
    }

    @keyframes borderRotate {
      0% {
        --border-angle: 0deg;
      }
      100% {
        --border-angle: 360deg;
      }
    }

    /* CSS custom property animation support */
    @property --border-angle {
      syntax: '<angle>';
      initial-value: 0deg;
      inherits: false;
    }


    /* Card Back (ê²°ê³¼ ì¹´ë“œ) - ì¼ë°˜ ì¹´ë“œ ë’·ë©´ */
    .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      background: url('./images/card-front_back.png') center/cover no-repeat;
      border-radius: 12px;
      border: none;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      backface-visibility: hidden;
      transform: rotateY(180deg);
      box-sizing: border-box;
      overflow: hidden;
    }

    /* ì½˜í…ì¸  ì˜ì—­: í”¼ê·¸ë§ˆ ê¸°ì¤€ width:162px, ì„¸ë¡œì¤‘ì•™ */
    .card-back .result-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 162px;
    }

    /* REWARD ë±ƒì§€: í”¼ê·¸ë§ˆ ê¸°ì¤€ */
    .card-back .result-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #050a1a;
      color: #fff;
      height: 14px;
      padding: 0 5.5px;
      border-radius: 2px;
      font-size: 11px;
      font-weight: 400;
      line-height: 12.776px;
      letter-spacing: 0;
      white-space: nowrap;
      margin-bottom: 18px;
    }

    /* ê¸ˆì•¡+ì„œë¸Œí…ìŠ¤íŠ¸ ë¬¶ìŒ: í”¼ê·¸ë§ˆ ê¸°ì¤€ gap:8px */
    .card-back .result-info {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      width: 100%;
      margin-bottom: 0;
    }

    /* ê¸ˆì•¡: í”¼ê·¸ë§ˆ ê¸°ì¤€ 28px SemiBold */
    .card-back .result-amount {
      font-size: 28px;
      font-weight: 600;
      color: #000;
      line-height: 1.3;
      text-align: center;
      margin: 0;
    }

    /* ì„œë¸Œí…ìŠ¤íŠ¸: í”¼ê·¸ë§ˆ ê¸°ì¤€ 13px Regular #666 */
    .card-back .result-text {
      font-size: 13px;
      font-weight: 400;
      color: #666;
      line-height: 1.3;
      text-align: center;
      margin: 0;
    }

    /* obj ì´ë¯¸ì§€: í”¼ê·¸ë§ˆ ê¸°ì¤€ 100x100 */
    .card-back .result-image {
      width: 100px;
      height: 100px;
      min-width: 100px;
      min-height: 100px;
      background: url('./images/card-front_back_obj.png?v=2') center center no-repeat;
      background-size: cover;
      flex-shrink: 0;
      margin-top: 0;
    }

    /* Special Card Back (ìŠ¤í˜ì…œ ë’·ë©´) */
    .card-back-special {
      background: url('./images/card-special-front_back.png') center/cover no-repeat;
      border: none;
    }

    .card-back-special .result-badge {
      background: linear-gradient(115.761deg, #399EFF 5.8655%, #7450FF 114.6%);
    }

    .card-back-special .result-amount,
    .card-back-special .result-text {
      color: #000;
    }

    .card-back-special .result-image {
      width: 100px;
      height: 100px;
      min-width: 100px;
      min-height: 100px;
      background: url('./images/card-special-front_back_obj.png') center center no-repeat;
      background-size: 100% 100%;
    }


    /* Empty State */
    .empty-state {
      display: none;
      width: 200px;
      height: 300px;
      min-height: 300px;
      background: url('./images/no%20rewards.png?v=2') center/cover no-repeat;
      border-radius: 12px;
      flex-shrink: 0;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 0;
      overflow: hidden;
      color: transparent;
      font-size: 0;
      padding: 0;
    }

    .empty-state.show {
      display: block;
    }

    .empty-state.show.fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .empty-state * {
      display: none !important;
    }

    .empty-state h3 {
      font-size: 16px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 24px;
    }

    .empty-state .empty-image {
      width: 80px;
      height: 80px;
      background: #444;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 12px;
      font-weight: 500;
    }

    .empty-state p {
      display: none;
    }

    /* Card Info - í•˜ë‹¨ ì •ë³´ */
    .card-info {
      text-align: center;
    }

    .card-info .info-label {
      font-size: 14px;
      color: #777;
      margin-bottom: 8px;
    }

    .card-info .time-badge {
      display: inline-block;
      background: rgba(30, 80, 180, 0.3);
      color: rgba(56, 109, 255, 1);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .card-info .btn-tertiary {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      color: #FFFFFF;
      border: 1px solid #E0E0E0;
      border-radius: 6px;
      padding: 4px 12px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .card-info .btn-tertiary:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    /* Empty Info - ì¹´ë“œ ì—†ì„ ë•Œ í•˜ë‹¨ ì •ë³´ */
    .empty-info {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      text-align: center;
      font-family: 'Pretendard', sans-serif;
      font-size: 14px;
      font-weight: 400;
      line-height: 1.2;
      color: #777;
      display: none;
    }

    .empty-info.show {
      display: block;
    }

    /* ========== Card Info Area (ê°€ë³€ íŒ¨ë”©) ========== */
    .card-info-area {
      flex-shrink: 0;
      width: 100%;
      padding: 0 20px 32px;
      margin-top: 0;
      text-align: center;
      position: relative;
    }

    /* ========== Bottom Area ========== */
    .bottom-area {
      background: transparent;
      padding: 0 16px;
      position: relative;
      z-index: 10;
      color: rgba(0, 0, 0, 0);
    }

    .bottom-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 12px 0 8px;
    }

    .btn {
      width: 100%;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
    }

    .btn-primary {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1 0 0;
      padding: 12px 16px;
      background: #fff;
      color: #000;
      border-radius: 4px;
      font-family: 'Pretendard', sans-serif;
      font-size: 14px;
      font-weight: 500;
    }

    .btn-primary:hover {
      background: #f5f5f5;
    }

    .btn-primary:disabled {
      background: #f5f5f5;
      border: 1px solid #ebebeb;
      color: #ccc;
      cursor: not-allowed;
    }

    .btn-primary.loading {
      flex-direction: row !important;
      gap: 8px;
    }

    .btn-primary.loading .spinner {
      width: 16px;
      height: 16px;
      border: 2px solid #ddd;
      border-top-color: #000;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      flex-shrink: 0;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Home Indicator */
    .home-indicator {
      display: flex;
      height: 34px;
      padding: 21px 120px 8px 121px;
      justify-content: center;
      align-items: center;
      align-self: stretch;
      background: transparent;
    }

    .home-indicator-bar {
      width: 134px;
      height: 5px;
      background: #fff;
      border-radius: 3px;
    }

    /* ========== Toast ========== */
    .toast {
      position: absolute;
      top: 156px;
      left: 50%;
      transform: translateX(-50%) translateY(-20px);
      background: #fff;
      color: #000;
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 14px;
      font-weight: 500;
      letter-spacing: -0.28px;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      z-index: 100;
      white-space: nowrap;
      box-shadow: 0 4px 20px rgba(34, 197, 94, 0.3);
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* ========== Modal ========== */
    .modal-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
    }

    .modal-overlay.show {
      display: flex;
      animation: fadeIn 0.2s ease-out;
    }

    .modal {
      background: #fff;
      border-radius: 8px;
      width: 280px;
      text-align: center;
      overflow: hidden;
    }

    .modal-content {
      padding: 20px 16px 0;
    }

    .modal-text {
      font-size: 14px;
      font-weight: 500;
      color: #000;
      line-height: 20px;
      text-align: center;
    }

    .modal-buttons {
      padding: 24px 16px 20px;
      background: #fff;
    }

    .modal .btn-modal {
      width: 100%;
      height: 40px;
      padding: 10px 16px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      line-height: 20px;
      cursor: pointer;
    }


    /* ========== Demo Controls ========== */
    .demo-controls-external {
      display: flex;
      gap: 10px;
      padding: 12px 20px;
      background: #2a2a2a;
      border-radius: 12px;
    }

    .demo-controls-external .demo-btn {
      padding: 10px 20px;
      background: #3a3a3a;
      border: 1px solid #4a4a4a;
      border-radius: 4px;
      color: #999;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Pretendard', sans-serif;
    }

    .demo-controls-external .demo-btn:hover {
      background: #4a4a4a;
      color: #fff;
    }

    .demo-controls-external .demo-btn.active {
      background: #3b82f6;
      border-color: #3b82f6;
      color: #fff;
    }

    .demo-label {
      display: block;
      padding: 8px 0 4px 0;
      color: #999;
      font-size: 12px;
      font-weight: 500;
      font-family: 'Pretendard', sans-serif;
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <div class="device-frame">
    <!-- ë°°ê²½ ê·¸ë˜í”½ ë ˆì´ì–´ -->
    <div class="bg-layer">
      <img src="./images/bg.png" alt="" class="bg-image">
      <div class="bg-blur"></div>
    </div>
    
    <!-- ========== ìƒë‹¨ ê³ ì • ì˜ì—­ ========== -->
    <div class="top-fixed-area">
      <!-- Status Bar -->
      <div class="status-bar">
        <span class="status-time">9:41</span>
        <div class="status-icons">
          <svg width="17" height="11" viewBox="0 0 17 11" fill="none">
            <path d="M8.5 2C10.7 2 12.7 2.9 14.2 4.3L15.8 2.7C13.9 0.8 11.3 -0.3 8.5 -0.3C5.7 -0.3 3.1 0.8 1.2 2.7L2.8 4.3C4.3 2.9 6.3 2 8.5 2Z" fill="#000"/>
            <path d="M8.5 5C9.9 5 11.2 5.5 12.2 6.3L13.8 4.7C12.4 3.5 10.5 2.7 8.5 2.7C6.5 2.7 4.6 3.5 3.2 4.7L4.8 6.3C5.8 5.5 7.1 5 8.5 5Z" fill="#000"/>
            <path d="M8.5 8C9.2 8 9.9 8.3 10.4 8.8L8.5 10.7L6.6 8.8C7.1 8.3 7.8 8 8.5 8Z" fill="#000"/>
          </svg>
          <svg width="25" height="12" viewBox="0 0 25 12" fill="none">
            <rect x="0.5" y="0.5" width="21" height="11" rx="2.5" stroke="#000" stroke-opacity="0.35"/>
            <rect x="23" y="3.5" width="1.5" height="5" rx="0.5" fill="#000" fill-opacity="0.4"/>
            <rect x="2" y="2" width="18" height="8" rx="1.5" fill="#000"/>
          </svg>
        </div>
      </div>

      <!-- Navigation -->
      <div class="nav-header">
        <div class="nav-back">
          <svg viewBox="0 0 10 18" fill="none">
            <path d="M9 1L1 9L9 17" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          ë§¤ì¼ë¨¸ë‹ˆë°›ê¸°
        </div>
        <svg class="nav-home" viewBox="0 0 24 24" fill="none">
          <path d="M3 10.5L12 3L21 10.5V20C21 20.55 20.55 21 20 21H4C3.45 21 3 20.55 3 20V10.5Z" stroke="#000" stroke-width="1.5" stroke-linejoin="round"/>
        </svg>
      </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
      <span id="toastMessage">20ì› ì ë¦½ì™„ë£Œ!</span>
    </div>

    <!-- ========== ê°€ë³€ ì˜ì—­ (ë·°í¬íŠ¸ ë†’ì´ì— ë”°ë¼ ì¤„ì–´ë“¦) ========== -->
    <div class="flexible-area">
      <!-- Tab Menu -->
      <div class="tab-menu">
        <div class="tab-item active">ë¨¸ë‹ˆë°›ê¸°</div>
        <div class="tab-item">ë¨¸ë‹ˆë¯¸ì…˜</div>
        <div class="tab-item">ë°›ì€ ë¨¸ë‹ˆ ì¡°íšŒ</div>
      </div>

      <!-- Money Summary -->
      <div class="main-content">
        <div class="money-summary">
          <svg class="info-icon" viewBox="0 0 22 22" fill="none">
            <circle cx="11" cy="11" r="10" stroke="#fff" stroke-width="1.5"/>
            <path d="M11 15V11M11 7H11.01" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <div class="money-info">
            <h2>ì´ë²ˆë‹¬ ë°›ì€ ë¬´ì‹ ì‚¬ ë¨¸ë‹ˆ</h2>
            <div class="money-amount">
              <span id="totalMoney">0ì›</span>
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M9 18L15 12L9 6" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>
        </div>

        <!-- Card Badges -->
        <div class="card-badges">
          <div class="badge-container">
            <span class="badge-label">ë³´ìœ ì¹´ë“œ</span>
            <div class="badge-divider"></div>
            <div class="badge-items">
              <div class="badge-item">
                <div class="badge-icon special"></div>
                <span class="badge-count" id="specialCount">1</span>
              </div>
              <div class="badge-item">
                <div class="badge-icon mileage"></div>
                <span class="badge-count" id="mileageCount">2</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Background -->
      <div class="bg-container">
        <div class="bg-glow"></div>
      </div>

      <!-- Card Wrapper (í´ë¦¬í•‘ ì˜ì—­) -->
      <div class="card-wrapper">
        <!-- Card Area -->
        <div class="card-area">
          <!-- Empty State (ë¯¸ë¦¬ ë¡œë“œ, ì¹´ë“œ ë’¤ì— ë°°ì¹˜) -->
          <div class="empty-state" id="emptyState">
            <h3>No rewards left</h3>
            <div class="empty-image">image</div>
          </div>

          <!-- Card Stack with Flip Cards -->
          <div class="card-stack" id="cardStack">
            <div class="flip-card" id="card1">
              <div class="card-front"></div>
              <div class="card-back">
                <div class="result-content">
                  <div class="result-badge">REWARD</div>
                  <div class="result-info">
                    <div class="result-amount">20ì›</div>
                    <div class="result-text">ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”</div>
                  </div>
                  <div class="result-image"></div>
                </div>
              </div>
            </div>
            <div class="flip-card special" id="card2" data-card-type="special">
              <div class="card-front card-front-special"></div>
              <div class="card-back card-back-special">
                <div class="result-content">
                  <div class="result-badge">SPECIAL</div>
                  <div class="result-info">
                    <div class="result-amount">3,000ì›</div>
                    <div class="result-text">ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”</div>
                  </div>
                  <div class="result-image"></div>
                </div>
              </div>
            </div>
            <div class="flip-card" id="card3">
              <div class="card-front"></div>
              <div class="card-back">
                <div class="result-content">
                  <div class="result-badge">REWARD</div>
                  <div class="result-info">
                    <div class="result-amount">20ì›</div>
                    <div class="result-text">ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”</div>
                  </div>
                  <div class="result-image"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Card Info Area (ê°€ë³€ íŒ¨ë”©) -->
        <div class="card-info-area">
          <div class="card-info" id="cardInfo">
            <div class="info-label" id="infoLabel">ì¶œì„ì²´í¬ ë¦¬ì›Œë“œ | 11.04</div>
            <div class="time-badge" id="timeBadge">12:24:55 ë‚¨ìŒ</div>
          </div>
          <div class="empty-info" id="emptyInfo">ì—´ê¸° ê°€ëŠ¥í•œ ë¦¬ì›Œë“œ ì¹´ë“œê°€ ì—†ì–´ìš”</div>
        </div>
      </div>
    </div>

    <!-- ========== í•˜ë‹¨ ê³ ì • ì˜ì—­ ========== -->
    <div class="bottom-fixed-area">
      <div class="bottom-area">
        <div class="bottom-buttons">
          <button class="btn btn-primary" id="openAllBtn">ì¹´ë“œ í•œë²ˆì— ì—´ê¸°</button>
        </div>
        <div class="home-indicator">
          <div class="home-indicator-bar"></div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay">
      <div class="modal">
        <div class="modal-content">
          <div class="modal-text">ì¼ë¶€ ë¦¬ì›Œë“œë¥¼ ì—´ì§€ ëª»í–ˆì–´ìš”.<br>ë‚¨ì€ ë¦¬ì›Œë“œë¥¼ ë‹¤ì‹œ ì—´ì–´ì£¼ì„¸ìš”.</div>
        </div>
        <div class="modal-buttons">
          <button class="btn-modal" onclick="closeModal()">í™•ì¸</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Demo Controls -->
  <div class="demo-label">í•œë²ˆì— ì—´ê¸° ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</div>
  <div class="demo-controls-external">
    <button class="demo-btn active" onclick="setScenario('success')">ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤</button>
    <button class="demo-btn" onclick="setScenario('partial')">ì¼ë¶€ ì‹¤íŒ¨</button>
    <button class="demo-btn" onclick="setOpenAllScenario('all-normal')">í•œë²ˆì— ì—´ê¸° - ëª¨ë‘ ì¼ë°˜</button>
    <button class="demo-btn" onclick="setOpenAllScenario('special-front')">í•œë²ˆì— ì—´ê¸° - ìŠ¤í˜ì…œ ì¹´ë“œê°€ ë§¨ ì•</button>
    <button class="demo-btn" onclick="resetDemo()">ì´ˆê¸°í™”</button>
  </div>

  <script>
    let currentScenario = 'success';
    let isProcessing = false;
    let specialCount = 1;
    let mileageCount = 2;
    let totalMoney = 0;
    let currentCardIndex = 3; // 3ì¥ë¶€í„° ì‹œì‘ (ë’¤ì—ì„œë¶€í„° ì˜¤í”ˆ)

    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');
    const cardStack = document.getElementById('cardStack');
    const emptyState = document.getElementById('emptyState');
    const cardInfo = document.getElementById('cardInfo');
    const openAllBtn = document.getElementById('openAllBtn');
    const modalOverlay = document.getElementById('modalOverlay');
    const specialCountEl = document.getElementById('specialCount');
    const mileageCountEl = document.getElementById('mileageCount');
    const totalMoneyEl = document.getElementById('totalMoney');
    const timeBadge = document.getElementById('timeBadge');

    // Timer
    let timeLeft = 12 * 3600 + 24 * 60 + 55;
    let timerInterval = null;
    let isTimerStopped = false;
    
    timerInterval = setInterval(() => {
      if (isTimerStopped) return; // íƒ€ì´ë¨¸ ì¤‘ì§€ ì‹œ ì—…ë°ì´íŠ¸ ì•ˆí•¨
      timeLeft--;
      if (timeLeft < 0) timeLeft = 24 * 3600;
      const h = Math.floor(timeLeft / 3600);
      const m = Math.floor((timeLeft % 3600) / 60);
      const s = timeLeft % 60;
      timeBadge.textContent = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')} ë‚¨ìŒ`;
    }, 1000);

    // ì´ˆê¸° ì¹´ë“œ ìˆ˜ì— ë”°ë¼ ë²„íŠ¼ í‘œì‹œ ì„¤ì •
    function updateButtonState() {
      const totalCards = specialCount + mileageCount;
      if (totalCards <= 0) {
        openAllBtn.textContent = 'ì¹´ë“œì—´ê¸°';
        openAllBtn.disabled = true;
        openAllBtn.onclick = null;
      } else if (totalCards === 1) {
        openAllBtn.textContent = 'ì¹´ë“œì—´ê¸°';
        openAllBtn.disabled = false;
        openAllBtn.onclick = openSingleCard;
      } else {
        openAllBtn.textContent = 'ì¹´ë“œ í•œë²ˆì— ì—´ê¸°';
        openAllBtn.disabled = false;
        openAllBtn.onclick = openAllAtOnce;
      }
    }
    
    // ì¹´ë“œ ì•ë©´ í´ë¦­ ì‹œ í”Œë¦½ ê¸°ëŠ¥
    function initCardFrontClick() {
      const cardFronts = document.querySelectorAll('.card-front');
      cardFronts.forEach((cardFront, index) => {
        cardFront.addEventListener('click', (e) => {
          e.stopPropagation();
          const flipCard = cardFront.closest('.flip-card');
          // ë§¨ ì• ì¹´ë“œë§Œ í´ë¦­ ê°€ëŠ¥ (z-index 3)
          if (flipCard && flipCard.id === 'card' + currentCardIndex && !isProcessing && mileageCount > 0) {
            openSingleCard();
          }
        });
      });
    }
    
    // ì´ˆê¸°í™”
    (function init() {
      updateButtonState();
      initCardFrontClick();
    })();

    function setScenario(scenario) {
      currentScenario = scenario;
      document.querySelectorAll('.demo-controls-external .demo-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function setOpenAllScenario(scenario) {
      // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
      document.querySelectorAll('.demo-controls-external .demo-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      // ì¹´ë“œ ìƒíƒœ ì´ˆê¸°í™”
      currentCardIndex = 3;
      totalMoney = 0;
      isProcessing = false;
      
      // ëª¨ë“  ì¹´ë“œ ì´ˆê¸°í™”
      for (let i = 1; i <= 3; i++) {
        const card = document.getElementById('card' + i);
        if (!card) continue;
        
        // ëª¨ë“  í´ë˜ìŠ¤ ì œê±°
        card.classList.remove('special', 'hidden', 'move-front', 'move-back', 'flipping', 'press-flip', 'merge', 'bounce', 'border-loading', 'merge-flip');
        
        // ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” ë° ê¸°ë³¸ ìœ„ì¹˜ ì„¤ì •
        card.style.cssText = '';
        card.style.transition = 'none'; // ì¦‰ì‹œ ì´ˆê¸°í™” (ì• ë‹ˆë©”ì´ì…˜ ì—†ì´)
        card.style.visibility = 'visible';
        card.style.opacity = '1';
        
        // ê¸°ë³¸ ìœ„ì¹˜ë¡œ ë³µì› (CSS nth-child ê·œì¹™ì— ë”°ë¼)
        // rotateY(0deg) ì¶”ê°€í•˜ì—¬ ë’¤ì§‘ì–´ì§„ ì¹´ë“œë„ ì•ë©´ìœ¼ë¡œ ë³µì›
        if (i === 1) {
          // ë§¨ ë’¤ ì¹´ë“œ (ìˆ¨ê¹€)
          card.style.transform = 'translate(-50%, -50%) translateX(6px) translateY(-5px) rotate(8deg) rotateY(0deg)';
          card.style.zIndex = '1';
          card.style.opacity = '0';
        } else if (i === 2) {
          // ë’·ì¥ (ë³´ì„, 8ë„ ê¸°ìš¸ê¸°)
          card.style.transform = 'translate(-50%, -50%) translateX(6px) translateY(-5px) rotate(8deg) rotateY(0deg)';
          card.style.zIndex = '2';
          card.style.opacity = '1';
        } else if (i === 3) {
          // ë§¨ ì•ì¥ (ë³´ì„, 0ë„)
          card.style.transform = 'translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg) rotateY(0deg)';
          card.style.zIndex = '3';
          card.style.opacity = '1';
        }
        
        // ì¹´ë“œ ì•ë©´ ì´ˆê¸°í™”
        const cardFront = card.querySelector('.card-front');
        if (cardFront) {
          cardFront.classList.remove('card-front-special');
          cardFront.style.cssText = ''; // ì•ë©´ ìŠ¤íƒ€ì¼ë„ ì´ˆê¸°í™”
        }
        
        // ì¹´ë“œ ë’·ë©´ ì´ˆê¸°í™”
        const cardBack = card.querySelector('.card-back');
        if (cardBack) {
          cardBack.classList.remove('card-back-special');
          cardBack.style.cssText = ''; // ë’·ë©´ ìŠ¤íƒ€ì¼ë„ ì´ˆê¸°í™”
          cardBack.style.visibility = 'visible';
          const badge = cardBack.querySelector('.result-badge');
          const amount = cardBack.querySelector('.result-amount');
          const text = cardBack.querySelector('.result-text');
          if (badge) badge.textContent = 'REWARD';
          if (amount) amount.textContent = '20ì›';
          if (text) text.innerHTML = 'ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”';
        }
      }
      
      // ì‹œë‚˜ë¦¬ì˜¤ì— ë”°ë¼ ì¹´ë“œ íƒ€ì… ì„¤ì •
      if (scenario === 'all-normal') {
        // ëª¨ë“  ì¹´ë“œë¥¼ ì¼ë°˜ ì¹´ë“œë¡œ ì„¤ì •
        for (let i = 1; i <= 3; i++) {
          const card = document.getElementById('card' + i);
          if (card) {
            card.classList.remove('special');
            const cardFront = card.querySelector('.card-front');
            const cardBack = card.querySelector('.card-back');
            if (cardFront) cardFront.classList.remove('card-front-special');
            if (cardBack) cardBack.classList.remove('card-back-special');
          }
        }
        specialCount = 0;
        mileageCount = 3;
      } else if (scenario === 'special-front') {
        // card3(ë§¨ ì• ì¹´ë“œ)ë¥¼ ìŠ¤í˜ì…œ ì¹´ë“œë¡œ ì„¤ì •
        const card3 = document.getElementById('card3');
        if (card3) {
          card3.classList.add('special');
          const cardFront = card3.querySelector('.card-front');
          const cardBack = card3.querySelector('.card-back');
          if (cardFront) cardFront.classList.add('card-front-special');
          if (cardBack) {
            cardBack.classList.add('card-back-special');
            const badge = cardBack.querySelector('.result-badge');
            const amount = cardBack.querySelector('.result-amount');
            if (badge) badge.textContent = 'SPECIAL';
            if (amount) amount.textContent = '3,000ì›';
          }
        }
        // card1, card2ëŠ” ì¼ë°˜ ì¹´ë“œ
        const card1 = document.getElementById('card1');
        const card2 = document.getElementById('card2');
        if (card1) card1.classList.remove('special');
        if (card2) card2.classList.remove('special');
        specialCount = 1;
        mileageCount = 2;
      } else if (scenario === 'success') {
        // ì„±ê³µ ì‹œë‚˜ë¦¬ì˜¤: card2ê°€ ìŠ¤í˜ì…œ ì¹´ë“œ (ê¸°ë³¸ ìƒíƒœ)
        const card2 = document.getElementById('card2');
        if (card2) {
          card2.classList.add('special');
          const cardFront = card2.querySelector('.card-front');
          const cardBack = card2.querySelector('.card-back');
          if (cardFront) cardFront.classList.add('card-front-special');
          if (cardBack) {
            cardBack.classList.add('card-back-special');
            const badge = cardBack.querySelector('.result-badge');
            const amount = cardBack.querySelector('.result-amount');
            if (badge) badge.textContent = 'SPECIAL';
            if (amount) amount.textContent = '3,000ì›';
          }
        }
        // card1, card3ëŠ” ì¼ë°˜ ì¹´ë“œ
        const card1 = document.getElementById('card1');
        const card3 = document.getElementById('card3');
        if (card1) card1.classList.remove('special');
        if (card3) card3.classList.remove('special');
        specialCount = 1;
        mileageCount = 2;
      }
      
      // ì¹´ë“œ ìˆ˜ ì—…ë°ì´íŠ¸
      updateCounts(specialCount, mileageCount);
      
      // ì´ ê¸ˆì•¡ ì´ˆê¸°í™”
      totalMoneyEl.textContent = '0ì›';
      
      // ì¹´ë“œ ìŠ¤íƒ í‘œì‹œ
      cardStack.style.display = '';
      
      // Empty state ìˆ¨ê¸°ê¸°
      emptyState.classList.remove('show', 'fade-in');
      cardInfo.style.display = '';
      document.getElementById('emptyInfo').classList.remove('show');
      
      // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      openAllBtn.classList.remove('loading'); // loading í´ë˜ìŠ¤ ì œê±°
      updateButtonState();
      
      // íƒ€ì´ë¨¸ ì¬ì‹œì‘
      isTimerStopped = false;
      const timeBadgeEl = document.getElementById('timeBadge');
      timeBadgeEl.className = 'time-badge';
      timeBadgeEl.textContent = '12:24:55 ë‚¨ìŒ';
      timeBadgeEl.onclick = null;
    }

    function showToast(message, duration = 2500, onComplete = null) {
      toastMessage.textContent = message;
      toast.classList.add('show');
      setTimeout(() => { toast.classList.remove('show'); if (onComplete) onComplete(); }, duration);
    }

    function showModal() {
      modalOverlay.classList.add('show');
    }

    async function closeModal() {
      modalOverlay.classList.remove('show');
      
      // ì¼ë¶€ ì‹¤íŒ¨ í›„ ëª¨ë‹¬ ë‹«ì„ ë•ŒëŠ” ì¹´ë“œ ìƒíƒœë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€
      // confirmAllCardsOpenedì—ì„œ ì´ë¯¸ 1ì¥ë§Œ ë³´ì´ë„ë¡ ì„¤ì •ë¨
      // ë²„íŠ¼ ìƒíƒœë§Œ ì—…ë°ì´íŠ¸
      updateButtonState();
    }

    function updateCounts(special, mileage) {
      specialCount = special;
      mileageCount = mileage;
      specialCountEl.textContent = special;
      mileageCountEl.textContent = mileage;
      updateButtonState();
    }

    function updateTotalMoney(amount) {
      const startValue = totalMoney;
      const endValue = amount;
      const duration = 1200; // ë” ê¸´ ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„
      const startTime = performance.now();
      
      // easeOutQuart - ë” ë¶€ë“œëŸ¬ìš´ ê°ì†
      function easeOutQuart(t) {
        return 1 - Math.pow(1 - t, 4);
      }
      
      function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const easeProgress = easeOutQuart(progress);
        
        const currentValue = Math.round(startValue + (endValue - startValue) * easeProgress);
        totalMoneyEl.textContent = currentValue.toLocaleString() + 'ì›';
        
        // ìˆ«ì ë³€ê²½ ì‹œ ì‚´ì§ ìŠ¤ì¼€ì¼ íš¨ê³¼
        if (progress < 0.3) {
          const scale = 1 + (0.08 * (1 - progress / 0.3));
          totalMoneyEl.style.transform = `scale(${scale})`;
        } else {
          totalMoneyEl.style.transform = 'scale(1)';
        }
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          totalMoney = amount;
          totalMoneyEl.style.transform = 'scale(1)';
        }
      }
      
      requestAnimationFrame(animate);
    }

    // ì¹´ë“œ 1ì¥ ì˜¤í”ˆ (í”Œë¦½ â†’ ìœ„ë¡œ ì‚¬ë¼ì§ â†’ ë‹¤ìŒ ì¹´ë“œ ì•ìœ¼ë¡œ)
    async function openSingleCard() {
      const totalCards = specialCount + mileageCount;
      if (isProcessing || totalCards <= 0) return;
      
      isProcessing = true;
      openAllBtn.disabled = true;
      
      const currentCard = document.getElementById('card' + currentCardIndex);
      const nextCard = currentCardIndex > 1 ? document.getElementById('card' + (currentCardIndex - 1)) : null;
      const waitingCard = currentCardIndex > 2 ? document.getElementById('card' + (currentCardIndex - 2)) : null;
      
      // í˜„ì¬ ì¹´ë“œì˜ ì´ì „ í´ë˜ìŠ¤ ì œê±° ë° ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
      currentCard.classList.remove('move-front', 'move-back', 'press-flip');
      currentCard.style.cssText = '';
      
      // ë§¨ ì• ì¹´ë“œ ìœ„ì¹˜ë¡œ ì„¤ì •
      currentCard.style.transform = 'translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg)';
      currentCard.style.zIndex = '3';
      currentCard.style.opacity = '1';
      
      // 1. íƒ­ ì• ë‹ˆë©”ì´ì…˜ (ì‘ì•„ì¡Œë‹¤ê°€ ì»¤ì§€ë©´ì„œ í”Œë¦½)
      currentCard.classList.add('press-flip');
      
      // ì ë¦½ ì²˜ë¦¬ - ì¹´ë“œ í”Œë¦½ ì‹œì‘ê³¼ ë™ì‹œì— í† ìŠ¤íŠ¸ í‘œì‹œ
      const isSpecial = currentCard.classList.contains('special');
      const earnedMoney = isSpecial ? 3000 : 20;
      const newTotal = totalMoney + earnedMoney;
      showToast(`${earnedMoney.toLocaleString()}ì› ì ë¦½ì™„ë£Œ! ğŸ‰`, 1500, () => updateTotalMoney(newTotal));
      
      // press-flip ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ ëŒ€ê¸° (0.75s)
      await new Promise(r => setTimeout(r, 750));
      
      // press-flip ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ìƒíƒœ ê³ ì •
      currentCard.classList.remove('press-flip');
      currentCard.style.transform = 'translate(-50%, -50%) translateY(0) rotateY(180deg)';
      currentCard.style.zIndex = '10';

      // ì¹´ë“œ ìˆ˜ ê°ì†Œ (ìŠ¤í˜ì…œ/ì¼ë°˜ êµ¬ë¶„)
      if (isSpecial && specialCount > 0) {
        updateCounts(specialCount - 1, mileageCount);
      } else if (!isSpecial && mileageCount > 0) {
        updateCounts(specialCount, mileageCount - 1);
      }

      // í”Œë¦½ëœ ì¹´ë“œ 2ì´ˆ ë™ì•ˆ í™”ë©´ì— í‘œì‹œ
      await new Promise(r => setTimeout(r, 2000));

      // â˜… ë§ˆì§€ë§‰ ì¹´ë“œì¸ ê²½ìš° empty state ë¯¸ë¦¬ í‘œì‹œ (ì¹´ë“œ ë’¤ì— ë°°ì¹˜ë˜ì–´ ì•„ì§ ì•ˆë³´ì„)
      if ((specialCount + mileageCount) <= 0 && currentScenario === 'success') {
        emptyState.classList.add('show');
        cardInfo.style.display = 'none';
        document.getElementById('emptyInfo').classList.add('show');
      }

      // 2. í”Œë¦½ëœ ì¹´ë“œ ìœ„ë¡œ ë‚ ì•„ê°€ë©° ì‚¬ë¼ì§
      currentCard.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 1, 1)';
      currentCard.style.transform = 'translate(-50%, -50%) translateY(-600px) rotateY(180deg)';

      // 3. ë‹¤ìŒ ì¹´ë“œê°€ ì•ìœ¼ë¡œ ë‚˜ì˜´ (ê°ë„ 0ë„)
      if (nextCard) {
        nextCard.classList.remove('move-back');
        nextCard.classList.add('move-front');
      }

      // 4. ëŒ€ê¸° ì¤‘ì¸ ì¹´ë“œê°€ ë’·ì¥ ìœ„ì¹˜ë¡œ ì´ë™
      if (waitingCard) {
        waitingCard.classList.add('move-back');
      }

      await new Promise(r => setTimeout(r, 700));
      
      // í˜„ì¬ ì¹´ë“œ ì™„ì „íˆ ìˆ¨ê¹€
      currentCard.classList.add('hidden');
      currentCard.style.visibility = 'hidden';

      currentCardIndex--;

      // ëª¨ë“  ì¹´ë“œ ì˜¤í”ˆ ì™„ë£Œ
      if ((specialCount + mileageCount) <= 0) {
        await new Promise(r => setTimeout(r, 300));
        
        // ì¹´ë“œë¥¼ í•œ ì¥ì”© ì—´ì–´ì„œ ëª¨ë‘ ì—´ì—ˆìœ¼ë©´ í•­ìƒ ë¦¬ì›Œë“œ ì—†ìŒ í™”ë©´ í‘œì‹œ
        // ì¹´ë“œ ìŠ¤íƒ ìˆ¨ê¹€
        cardStack.style.display = 'none';
        emptyState.classList.add('show', 'fade-in');
        cardInfo.style.display = 'none';
        document.getElementById('emptyInfo').classList.add('show');
        openAllBtn.textContent = 'ì¹´ë“œì—´ê¸°';
        openAllBtn.disabled = true;
      }

      // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      updateButtonState();
      isProcessing = false;
    }

    // ì¹´ë“œ í•œë²ˆì— ì—´ê¸° (ëª¨ë“  ì¹´ë“œ í•©ì³ì„œ ë’¤ì§‘ê¸°)
    let pendingCardCount = 0; // í•œë²ˆì— ì—´ê¸° ì‹œ ì €ì¥í•  ì¹´ë“œ ìˆ˜
    
    async function openAllAtOnce() {
      const totalCards = specialCount + mileageCount;
      if (isProcessing || totalCards <= 0) return;
      
      isProcessing = true;
      pendingCardCount = currentCardIndex; // í˜„ì¬ ì¹´ë“œ ìˆ˜ ì €ì¥
      
      // ì¹´ë“œì—´ê¸° ë²„íŠ¼ ìƒíƒœ ë³€ê²½: í…ìŠ¤íŠ¸ + ìŠ¤í”¼ë„ˆ
      openAllBtn.classList.add('loading');
      openAllBtn.innerHTML = 'ì¹´ë“œë¥¼ í•œë²ˆì— ì—´ê³ ìˆì–´ìš” <span class="spinner"></span>';
      openAllBtn.disabled = true;

      // 1. ë§¨ ì• ì¹´ë“œ ì°¾ê¸° (move-front í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ì¹´ë“œ ë˜ëŠ” currentCardIndex ì¹´ë“œ)
      let frontCard = null;
      let frontCardIndex = currentCardIndex;
      
      // move-front í´ë˜ìŠ¤ë¥¼ ê°€ì§„ ì¹´ë“œ ì°¾ê¸° (ì¹´ë“œ í•œ ì¥ ì—´ì—ˆì„ ë•Œ ì•ìœ¼ë¡œ ë‚˜ì˜¨ ì¹´ë“œ)
      for (let i = currentCardIndex; i >= 1; i--) {
        const card = document.getElementById('card' + i);
        if (card && !card.classList.contains('hidden')) {
          if (card.classList.contains('move-front')) {
            frontCard = card;
            frontCardIndex = i;
            break;
          }
          // move-frontê°€ ì—†ìœ¼ë©´ currentCardIndex ì¹´ë“œê°€ ë§¨ ì•
          if (i === currentCardIndex) {
            frontCard = card;
            frontCardIndex = i;
            break;
          }
        }
      }
      
      // ë§¨ ì• ì¹´ë“œê°€ ì—†ìœ¼ë©´ currentCardIndex ì¹´ë“œë¥¼ ë§¨ ì•ìœ¼ë¡œ
      if (!frontCard) {
        frontCard = document.getElementById('card' + currentCardIndex);
        frontCardIndex = currentCardIndex;
      }
      
      // ë§¨ ì• ì¹´ë“œì˜ í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
      // move-front í´ë˜ìŠ¤ê°€ ìˆìœ¼ë©´ ê·¸ ìœ„ì¹˜, ì—†ìœ¼ë©´ ê¸°ë³¸ ì•ë©´ ìœ„ì¹˜
      let targetX = '0';
      let targetY = '0';
      let targetRotate = '0deg';
      
      if (frontCard) {
        // move-front í´ë˜ìŠ¤ê°€ ìˆìœ¼ë©´ ê·¸ ìœ„ì¹˜ ì‚¬ìš©
        if (frontCard.classList.contains('move-front')) {
          // move-frontëŠ” translateX(0) translateY(0) rotate(0deg)
          targetX = '0';
          targetY = '0';
          targetRotate = '0deg';
        } else {
          // í˜„ì¬ transformì—ì„œ ê°’ ì¶”ì¶œ
          const currentTransform = frontCard.style.transform || '';
          const xMatch = currentTransform.match(/translateX\(([^)]+)\)/);
          const yMatch = currentTransform.match(/translateY\(([^)]+)\)/);
          const rotateMatch = currentTransform.match(/rotate\(([^)]+deg)\)/);
          
          if (xMatch) targetX = xMatch[1];
          if (yMatch) targetY = yMatch[1];
          if (rotateMatch) targetRotate = rotateMatch[1];
        }
      }
      
      const finalTargetTransform = `translate(-50%, -50%) translateX(${targetX}) translateY(${targetY}) rotate(${targetRotate}) rotateY(0deg)`;

      // 2. ëª¨ë“  ì¹´ë“œë¥¼ ë§¨ ì• ì¹´ë“œ ìœ„ì¹˜ë¡œ í•©ì¹˜ê¸°
      for (let i = 1; i <= currentCardIndex; i++) {
        const card = document.getElementById('card' + i);
        if (!card) continue;
        
        // ëª¨ë“  ìƒíƒœ ì´ˆê¸°í™”
        card.classList.remove('hidden', 'merge', 'bounce', 'border-loading', 'press-flip', 'flipping', 'merge-flip', 'move-front', 'move-back');
        
        // ì¹´ë“œ ë’·ë©´ ì´ˆê¸°í™” (ìŠ¤í˜ì…œ ì¹´ë“œëŠ” í´ë˜ìŠ¤ ìœ ì§€)
        const cardBack = card.querySelector('.card-back');
        if (cardBack) {
          cardBack.style.visibility = 'visible';
          // ìŠ¤í˜ì…œ ì¹´ë“œê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ card-back-special í´ë˜ìŠ¤ ì œê±°
          if (!card.classList.contains('special')) {
            cardBack.classList.remove('card-back-special');
          }
        }
        
        // ì¹´ë“œ ìƒíƒœ ì„¤ì • - ì•ë©´ìœ¼ë¡œ, ë§¨ ì• ì¹´ë“œ ìœ„ì¹˜ë¡œ í•©ì¹˜ê¸°
        card.style.visibility = 'visible';
        card.style.opacity = '1';
        card.style.transition = 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
        card.style.transform = finalTargetTransform;
        
        // z-index ì„¤ì •: ë§¨ ì• ì¹´ë“œê°€ ê°€ì¥ ë†’ê³ , ìŠ¤í˜ì…œ ì¹´ë“œëŠ” ì¼ë°˜ ì¹´ë“œë³´ë‹¤ ë†’ê²Œ
        if (i === frontCardIndex) {
          card.style.zIndex = String(10); // ë§¨ ì• ì¹´ë“œê°€ ê°€ì¥ ë†’ìŒ
        } else if (card.classList.contains('special')) {
          card.style.zIndex = String(5); // ìŠ¤í˜ì…œ ì¹´ë“œëŠ” ì¼ë°˜ ì¹´ë“œë³´ë‹¤ ë†’ê²Œ
        } else {
          card.style.zIndex = String(3 + (currentCardIndex - i)); // ì¼ë°˜ ì¹´ë“œëŠ” ìˆœì„œëŒ€ë¡œ
        }
        
        card.classList.add('merge');
      }

      // ì¹´ë“œ í•©ì³ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ ëŒ€ê¸°
      await new Promise(r => setTimeout(r, 500));

      // 2. merge í´ë˜ìŠ¤ ì œê±°í•˜ê³  ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ì¤€ë¹„ (ë§¨ ì• ì¹´ë“œë§Œ)
      // ë§¨ ì• ì¹´ë“œë§Œ ë³´ë”ë¼ì´íŠ¸ì™€ ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ì ìš© (ì¼ë°˜ ì¹´ë“œì²˜ëŸ¼)
      const frontCardElement = document.getElementById('card' + frontCardIndex);
      
      if (frontCardElement) {
        // merge í´ë˜ìŠ¤ ì œê±°
        frontCardElement.classList.remove('merge');
        
        // transformì—ì„œ translateX, translateY, rotate ê°’ ì¶”ì¶œ
        const xMatch = finalTargetTransform.match(/translateX\(([^)]+)\)/);
        const yMatch = finalTargetTransform.match(/translateY\(([^)]+)\)/);
        const rotateMatch = finalTargetTransform.match(/rotate\(([^)]+)\)/);
        const translateX = xMatch ? xMatch[1] : '0';
        const translateY = yMatch ? yMatch[1] : '0';
        const rotate = rotateMatch ? rotateMatch[1] : '0deg';
        
        // ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ë™ì  keyframes ìƒì„±
        const animationName = `bounce-front-${Date.now()}`;
        const style = document.createElement('style');
        style.setAttribute('data-animation', animationName);
        style.textContent = `
          @keyframes ${animationName} {
            0%, 100% { 
              transform: translate(-50%, -50%) translateX(${translateX}) translateY(${translateY}) rotate(${rotate}) rotateY(0deg) scale(1); 
            }
            50% { 
              transform: translate(-50%, -50%) translateX(${translateX}) translateY(${translateY}) rotate(${rotate}) rotateY(0deg) scale(1.025); 
            }
          }
        `;
        document.head.appendChild(style);
        frontCardElement.dataset.bounceAnimation = animationName;
        
        // transformì„ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë¡œ ì„¤ì •
        frontCardElement.style.transform = finalTargetTransform;
        // ë™ì  ì• ë‹ˆë©”ì´ì…˜ ì ìš©
        frontCardElement.style.animation = `${animationName} 1s cubic-bezier(0.45, 0, 0.55, 1) 2`;
        frontCardElement.style.animationFillMode = 'both';
        
        // ë³´ë” ë¼ì´íŠ¸ ì¶”ê°€ (ëª¨ë“  ê²½ìš°)
        frontCardElement.classList.add('border-loading');
      }
      
      // ë’¤ì— ìˆëŠ” ì¹´ë“œë“¤ì€ merge í´ë˜ìŠ¤ë§Œ ì œê±°í•˜ê³  ìœ„ì¹˜ ìœ ì§€ (ë³´ì´ì§€ ì•ŠìŒ)
      for (let i = 1; i <= currentCardIndex; i++) {
        if (i === frontCardIndex) continue; // ë§¨ ì• ì¹´ë“œëŠ” ì´ë¯¸ ì²˜ë¦¬ë¨
        
        const card = document.getElementById('card' + i);
        if (!card) continue;
        
        // merge í´ë˜ìŠ¤ ì œê±°í•˜ì§€ë§Œ transformì€ ìœ ì§€
        card.classList.remove('merge');
        card.style.transform = finalTargetTransform;
        // ë’¤ ì¹´ë“œëŠ” ë³´ì´ì§€ ì•Šë„ë¡ (ë§¨ ì• ì¹´ë“œê°€ ë®ê³  ìˆìŒ)
      }

      // 2ì´ˆ ë™ì•ˆ ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ (1s Ã— 2ë²ˆ)
      await new Promise(r => setTimeout(r, 2000));

      // ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ì œê±°
      if (frontCardElement) {
        // ë™ì  ì• ë‹ˆë©”ì´ì…˜ ì œê±°
        const animationName = frontCardElement.dataset.bounceAnimation;
        if (animationName) {
          frontCardElement.style.animation = '';
          frontCardElement.style.animationFillMode = '';
          // ë™ì ìœ¼ë¡œ ìƒì„±í•œ style íƒœê·¸ ì œê±°
          const styleTag = document.querySelector(`style[data-animation="${animationName}"]`);
          if (styleTag) {
            styleTag.remove();
          }
          delete frontCardElement.dataset.bounceAnimation;
        }
        
        // ë°”ìš´ìŠ¤ ì œê±° í›„ì—ë„ ìœ„ì¹˜ ìœ ì§€
        frontCardElement.style.transform = finalTargetTransform;
      }
      
      // ìŠ¤í˜ì…œ ì¹´ë“œê°€ ë§¨ ì•ì¼ ë•ŒëŠ” ì•½ê°„ì˜ ëŒ€ê¸° ì‹œê°„ì„ ì£¼ì–´ ë¶€ë“œëŸ½ê²Œ ì „í™˜
      const isSpecialFront = frontCardElement && frontCardElement.classList.contains('special');
      if (isSpecialFront) {
        // ë³´ë”ë¼ì¸ ì œê±°
        frontCardElement.classList.remove('border-loading');
        // ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ í›„ ì•½ê°„ì˜ ì•ˆì •í™” ì‹œê°„
        await new Promise(r => setTimeout(r, 200));
      } else {
        // ì¼ë°˜ ì¹´ë“œì¸ ê²½ìš° ë³´ë”ë¼ì¸ ì œê±°
        if (frontCardElement) {
          frontCardElement.classList.remove('border-loading');
        }
      }

      // ì ë¦½ ê¸ˆì•¡ ê³„ì‚°
      let totalEarned = 0;
      for (let i = 1; i <= currentCardIndex; i++) {
        const card = document.getElementById('card' + i);
        if (card && !card.classList.contains('hidden')) {
          totalEarned += card.classList.contains('special') ? 3000 : 20;
        }
      }

      // ë§¨ ì• ì¹´ë“œì˜ ë’·ë©´ì— í•©ì‚° ê¸ˆì•¡ í‘œì‹œ (1000ì› ì´ìƒì´ë©´ ìŠ¤í˜ì…œ ë’·ë©´, ë¯¸ë§Œì´ë©´ ì¼ë°˜ ë’·ë©´)
      const actualFrontCard = document.getElementById('card' + frontCardIndex);
      if (actualFrontCard) {
        const frontCardBack = actualFrontCard.querySelector('.card-back');
        if (frontCardBack) {
          // í•©ì‚° ê¸ˆì•¡ì— ë”°ë¼ ë’·ë©´ ìŠ¤íƒ€ì¼ ê²°ì •
          if (totalEarned >= 1000) {
            frontCardBack.classList.add('card-back-special');
          } else {
            frontCardBack.classList.remove('card-back-special');
          }
          const badge = frontCardBack.querySelector('.result-badge');
          const amount = frontCardBack.querySelector('.result-amount');
          const text = frontCardBack.querySelector('.result-text');
          if (badge) badge.textContent = 'TOTAL REWARD';
          if (amount) amount.textContent = totalEarned.toLocaleString() + 'ì›';
          if (text) text.innerHTML = `ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•´ìš”`;
        }
      }

      // ë‚˜ë¨¸ì§€ ì¹´ë“œë“¤ì˜ ë’·ë©´ ìˆ¨ê¸°ê¸° (ë§¨ ì• ì¹´ë“œë§Œ ë³´ì´ë„ë¡)
      for (let i = 1; i <= currentCardIndex; i++) {
        if (i === frontCardIndex) continue; // ë§¨ ì• ì¹´ë“œëŠ” ì œì™¸
        const card = document.getElementById('card' + i);
        if (card) {
          const cardBack = card.querySelector('.card-back');
          if (cardBack) {
            cardBack.style.visibility = 'hidden';
          }
          // ë’¤ì— ìˆëŠ” ì¹´ë“œë“¤ì€ í”Œë¦½í•  ë•Œ ë³´ì´ì§€ ì•Šë„ë¡ ìˆ¨ê¹€
          card.style.opacity = '0';
        }
      }

      // 4. í•©ì³ì§„ ì¹´ë“œ í•œë²ˆì— í”Œë¦½ - ë§¨ ì• ì¹´ë“œ ìœ„ì¹˜ ê¸°ì¤€
      // ëª¨ë“  ì¹´ë“œê°€ í”Œë¦½ë˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë§¨ ì• ì¹´ë“œë§Œ ë³´ì„
      for (let i = 1; i <= currentCardIndex; i++) {
        const card = document.getElementById('card' + i);
        if (!card) continue;
        
        // ìŠ¤í˜ì…œ ì¹´ë“œê°€ ë§¨ ì•ì¼ ë•ŒëŠ” ë” ë¶€ë“œëŸ¬ìš´ í”Œë¦½ ì „í™˜ (ë” ê¸¸ê²Œ)
        const isSpecialCard = card.classList.contains('special');
        const flipDuration = isSpecialCard ? '1.0s' : '0.7s';
        const flipEasing = isSpecialCard ? 'cubic-bezier(0.34, 1.56, 0.64, 1)' : 'cubic-bezier(0.4, 0, 0.2, 1)';
        
        // ë§¨ ì• ì¹´ë“œë§Œ ë³´ì´ë„ë¡ z-index ì„¤ì •
        if (i === frontCardIndex) {
          // ë§¨ ì• ì¹´ë“œëŠ” ê°€ì¥ ë†’ì€ z-index
          card.style.zIndex = '10';
        } else {
          // ë’¤ì— ìˆëŠ” ì¹´ë“œë“¤ì€ ë‚®ì€ z-indexë¡œ ìˆ¨ê¹€
          card.style.zIndex = '1';
        }
        
        // ëª¨ë“  ì¹´ë“œ í”Œë¦½ (ë§¨ ì• ì¹´ë“œë§Œ ë³´ì´ì§€ë§Œ ëª¨ë“  ì¹´ë“œê°€ í”Œë¦½ë¨)
        // transitionì„ ë¨¼ì € ì„¤ì •
        card.style.transition = `transform ${flipDuration} ${flipEasing}`;
      }
      
      // transition ì„¤ì • í›„ ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ê³  transformì„ ì ìš©í•˜ì—¬ ì• ë‹ˆë©”ì´ì…˜ì´ ì¬ìƒë˜ë„ë¡
      await new Promise(r => setTimeout(r, 10));
      
      for (let i = 1; i <= currentCardIndex; i++) {
        const card = document.getElementById('card' + i);
        if (!card) continue;
        
        // ë§¨ ì• ì¹´ë“œì˜ ìœ„ì¹˜ë¥¼ ìœ ì§€í•˜ë©´ì„œ rotateYë§Œ 180ë„ë¡œ
        const flipTransform = finalTargetTransform.replace('rotateY(0deg)', 'rotateY(180deg)');
        card.style.transform = flipTransform;
      }

      // ì ë¦½ ì²˜ë¦¬ - ì¹´ë“œ í”Œë¦½ ì‹œì‘ê³¼ ë™ì‹œì— í† ìŠ¤íŠ¸ í‘œì‹œ
      const newTotal = totalMoney + totalEarned;
      showToast(`${totalEarned.toLocaleString()}ì› ì ë¦½ì™„ë£Œ! ğŸ‰`, 1500, () => updateTotalMoney(newTotal));

      await new Promise(r => setTimeout(r, 800));

      // ì¼ë¶€ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ì¸ ê²½ìš° 1ì¥ ë‚¨ê¸°ê¸°
      if (currentScenario === 'partial') {
        // 1ì¥ ë‚¨ê¸°ê¸°
        updateCounts(0, 1);
      } else {
        // ì¹´ë“œ ìˆ˜ 0ìœ¼ë¡œ (ëª¨ë“  ì¹´ë“œ ì˜¤í”ˆ)
        updateCounts(0, 0);
      }
      
      // ë²„íŠ¼ì„ "í™•ì¸"ìœ¼ë¡œ ë³€ê²½í•˜ê³  í™œì„±í™”
      openAllBtn.classList.remove('loading');
      openAllBtn.innerHTML = 'í™•ì¸';
      openAllBtn.disabled = false;
      openAllBtn.onclick = confirmAllCardsOpened;
      
      // ì¹´ë“œ ì •ë³´ í…ìŠ¤íŠ¸ ë³€ê²½: "ì´ Nê°œ ë¦¬ì›Œë“œ ì¹´ë“œ ì—´ì—ˆì–´ìš”"
      document.getElementById('infoLabel').textContent = `ì´ ${pendingCardCount}ê°œ ë¦¬ì›Œë“œ ì¹´ë“œ ì—´ì—ˆì–´ìš”`;
      
      // íƒ€ì´ë¨¸ ì¤‘ì§€ ë° "ìƒì„¸ë‚´ì—­ ë³´ê¸°" ë²„íŠ¼ìœ¼ë¡œ ë³€ê²½
      isTimerStopped = true;
      const timeBadgeEl = document.getElementById('timeBadge');
      timeBadgeEl.className = 'btn-tertiary';
      timeBadgeEl.textContent = 'ìƒì„¸ë‚´ì—­ ë³´ê¸°';
      timeBadgeEl.onclick = () => { alert('ìƒì„¸ë‚´ì—­ í˜ì´ì§€ë¡œ ì´ë™'); };
      
      isProcessing = false;
    }
    
    async function confirmAllCardsOpened() {
      if (isProcessing) return;
      isProcessing = true;
      
      openAllBtn.disabled = true;
      
      if (currentScenario === 'success') {
        // â˜… ì¹´ë“œê°€ ì‚¬ë¼ì§€ê¸° ì „ì— empty stateë¥¼ ë¯¸ë¦¬ ë³´ì—¬ì¤Œ (ì¹´ë“œ ë’¤ì— ìˆìœ¼ë¯€ë¡œ ì•„ì§ ì•ˆë³´ì„)
        emptyState.classList.add('show');
        cardInfo.style.display = 'none';
        document.getElementById('emptyInfo').classList.add('show');
        
        // ìœ„ë¡œ ë‚ ì•„ê°€ëŠ” ì• ë‹ˆë©”ì´ì…˜ (í™”ë©´ ë°–ìœ¼ë¡œ) - ë°”ë¡œ ì‹¤í–‰
        for (let i = 1; i <= pendingCardCount; i++) {
          const card = document.getElementById('card' + i);
          card.classList.remove('merge-flip');
          card.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 1, 1)';
          card.style.transform = 'translate(-50%, -50%) translateY(-600px) rotateY(180deg)';
          card.style.zIndex = '10';
        }

        await new Promise(r => setTimeout(r, 700));
        
        // ì• ë‹ˆë©”ì´ì…˜ í›„ ì™„ì „íˆ ìˆ¨ê¹€
        for (let i = 1; i <= pendingCardCount; i++) {
          const card = document.getElementById('card' + i);
          card.style.visibility = 'hidden';
        }

        // ì™„ë£Œ ì²˜ë¦¬
        openAllBtn.textContent = 'ì¹´ë“œì—´ê¸°';
        // ì¹´ë“œ ìŠ¤íƒ ìˆ¨ê¹€
        cardStack.style.display = 'none';
        openAllBtn.disabled = true;
        openAllBtn.onclick = null;
      } else {
        // ì¼ë¶€ ì‹¤íŒ¨: 1ì¥ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ëŠ” ì¦‰ì‹œ ìˆ¨ê¹€ (ì• ë‹ˆë©”ì´ì…˜ ì—†ìŒ)
        for (let i = 1; i < pendingCardCount; i++) {
          const card = document.getElementById('card' + i);
          if (card) {
            card.style.visibility = 'hidden';
            card.style.opacity = '0';
          }
        }
        
        // ë§ˆì§€ë§‰ ì¹´ë“œë§Œ ë³´ì´ë„ë¡ ì„¤ì • (ì•ë©´ìœ¼ë¡œ ì¦‰ì‹œ ë³µì›, ì• ë‹ˆë©”ì´ì…˜ ì—†ìŒ)
        const lastCard = document.getElementById('card' + pendingCardCount);
        if (lastCard) {
          // ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ì¦‰ì‹œ ì•ë©´ìœ¼ë¡œ ë³µì›
          lastCard.style.transition = 'none';
          lastCard.style.transform = 'translate(-50%, -50%) translateX(0) translateY(0) rotate(0deg) rotateY(0deg)';
          lastCard.style.zIndex = '3';
          lastCard.style.opacity = '1';
          lastCard.style.visibility = 'visible';
          
          // ë’·ë©´ ì´ˆê¸°í™”
          const cardBack = lastCard.querySelector('.card-back');
          if (cardBack) {
            cardBack.style.visibility = 'visible';
            cardBack.classList.remove('card-back-special');
            const badge = cardBack.querySelector('.result-badge');
            const amount = cardBack.querySelector('.result-amount');
            const text = cardBack.querySelector('.result-text');
            if (badge) badge.textContent = 'REWARD';
            if (amount) amount.textContent = '20ì›';
            if (text) text.innerHTML = 'ìƒí’ˆ êµ¬ë§¤ ì‹œ<br>ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”';
          }
          
          // ì•ë©´ ì´ˆê¸°í™”
          const cardFront = lastCard.querySelector('.card-front');
          if (cardFront) {
            cardFront.classList.remove('card-front-special');
            lastCard.classList.remove('special');
          }
        }
        
        // ì¹´ë“œ ìˆ˜ 1ì¥ ë‚¨ê¹€
        updateCounts(0, 1);
        currentCardIndex = pendingCardCount;
        
        // Empty state ìˆ¨ê¸°ê¸°
        emptyState.classList.remove('show', 'fade-in');
        document.getElementById('emptyInfo').classList.remove('show');
        cardInfo.style.display = '';
        
        // ì¹´ë“œ ì •ë³´ í…ìŠ¤íŠ¸ ë³µì›
        document.getElementById('infoLabel').textContent = 'ì¶œì„ì²´í¬ ë¦¬ì›Œë“œ | 11.04';
        const timeBadgeEl = document.getElementById('timeBadge');
        timeBadgeEl.className = 'time-badge';
        timeBadgeEl.textContent = '12:24:55 ë‚¨ìŒ';
        timeBadgeEl.onclick = null;
        isTimerStopped = false;
        
        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        openAllBtn.textContent = 'ì¹´ë“œì—´ê¸°';
        openAllBtn.disabled = false;
        openAllBtn.onclick = openSingleCard;
        
        // ì¼ë¶€ ì‹¤íŒ¨ ì²˜ë¦¬ í›„ì—ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ 'success'ë¡œ ë³€ê²½
        // ë‚¨ì€ 1ì¥ ì¹´ë“œë¥¼ ì—´ë©´ ë¦¬ì›Œë“œ ì—†ìŒ í™”ë©´ì´ ë‚˜ì˜¤ë„ë¡
        currentScenario = 'success';
        
        // ì•ŒëŸ¿ í‘œì‹œ
        showModal();
      }

      isProcessing = false;
    }

    function resetDemo() {
      location.reload();
    }
  </script>
</body>
</html>
